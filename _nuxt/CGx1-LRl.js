import{_ as q}from"./AY9KOh5v.js";import{_ as B}from"./BXxHOZkN.js";import{d as T,e as b,r as p,f as j,h as M,i as $,j as _,k as z,w as D,c as O,a as s,l as o,F as W,m as G,p as H,b as l,q as t,t as h,s as k,V as J,v as g,x as K,y as Y,z as Q,A as X,o as Z}from"./BSGE5GTI.js";import{V as ee}from"./D1PlKA43.js";import{V as y,a as u}from"./BA1Q-Lks.js";import{V as ae}from"./D77b0ex7.js";import{V as L}from"./DF6IzxTq.js";import{V as se}from"./CGIYWge0.js";import{V as te}from"./AGPsxxax.js";import{V as C}from"./CnJXHhAe.js";import"./Z4zssqwt.js";import"./BFpEfhYG.js";/* empty css        */import"./CNo6l2ZD.js";import"./D1b0O_WH.js";import"./DVOIMO_o.js";const oe=""+new URL("auth-v2-login-illustration-bordered-dark.cDkPk8mY.png",import.meta.url).href,re=""+new URL("auth-v2-login-illustration-bordered-light.CIHqcIVA.png",import.meta.url).href,le=""+new URL("auth-v2-login-illustration-dark.ClExSVqL.png",import.meta.url).href,ie=""+new URL("auth-v2-login-illustration-light.C4sKfRS1.png",import.meta.url).href,ne={class:"auth-logo d-flex align-center gap-x-3"},de={class:"auth-title"},ue={class:"position-relative bg-background w-100 me-0"},me={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},pe=["src"],ce={class:"text-h4 mb-1"},fe={class:"text-capitalize"},ge={class:"d-flex align-center flex-wrap justify-space-between my-6"},Ae=T({__name:"login",setup(ve){const I=b(ie,le,re,oe,!0),R=b(H,G),w=p(null),v=p(!1),V=p(!1),m=p(!1),n=p({email:"tenant1@choayo.dev",password:"password"}),c=p({email:void 0,password:void 0,general:void 0}),x={email:[a=>!!a||"Email is required",a=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)||"Email must be valid"],password:[a=>!!a||"Password is required",a=>a.length>=6||"Password must be at least 6 characters"]},P=j();M();const S=$(()=>{const a=P.query.redirect;return a&&a.startsWith("/")&&!a.includes("://")?a:"/"}),U=_("auth.user",{maxAge:m.value?60*60*24*30:60*60*24,sameSite:"lax"}),F=a=>{try{const e={id:a.id,email:a.email,name:a.name||a.fullName||a.username,role:a.role,permissions:a.permissions,avatar:a.avatar},d={maxAge:m.value?60*60*24*30:60*60*24,sameSite:"lax"};U.value=JSON.stringify(e)}catch(e){console.error("Failed to save user data:",e)}},{signIn:N}=z(),A=async()=>{var a,e,d;c.value={email:void 0,password:void 0,general:void 0};try{const{valid:i}=await((a=w.value)==null?void 0:a.validate())||{valid:!1};if(!i)return;V.value=!0;const r=await N({email:n.value.email,password:n.value.password,redirect:!1},{callbackUrl:S.value,external:!0}).then(f=>(console.log("res",f),f)).catch(({response:f,data:E,error:he})=>{c.value=E.errors});if(r!=null&&r.user&&F(r.user),m.value){const f=_("auth.remember",{maxAge:2592e3,sameSite:"lax"});f.value="true"}}catch(i){if(console.log("Error details:",i),i.status===422||((e=i.response)==null?void 0:e.status)===422){const r=((d=i.response)==null?void 0:d.data)||"Validation failed";console.log("Validation errors:",r)}return i}finally{V.value=!1}};return D([()=>n.value.email,()=>n.value.password],()=>{c.value={email:void 0,password:void 0,general:void 0}}),(a,e)=>{const d=q,i=B;return Z(),O(W,null,[s(d,{to:"/"},{default:o(()=>[l("div",ne,[s(t(ee),{nodes:t(h).app.logo},null,8,["nodes"]),l("h1",de,k(t(h).app.title),1)])]),_:1}),s(y,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:o(()=>[s(u,{md:"8",class:"d-none d-md-flex"},{default:o(()=>[l("div",ue,[l("div",me,[s(J,{"max-width":"613",src:t(I),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),l("img",{class:"auth-footer-mask",src:t(R),alt:"auth-footer-mask",height:"280",width:"100"},null,8,pe)])]),_:1}),s(u,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:o(()=>[s(ae,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:o(()=>[s(L,null,{default:o(()=>[l("h4",ce,[e[4]||(e[4]=g(" Welcome to ")),l("span",fe,k(t(h).app.title),1),e[5]||(e[5]=g("! 👋🏻 "))]),e[6]||(e[6]=l("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1))]),_:1}),s(L,null,{default:o(()=>[s(t(se),{ref_key:"refVForm",ref:w,onSubmit:K(A,["prevent"])},{default:o(()=>[s(y,null,{default:o(()=>[s(u,{cols:"12"},{default:o(()=>[s(i,{modelValue:t(n).email,"onUpdate:modelValue":e[0]||(e[0]=r=>t(n).email=r),label:"Email",placeholder:"johndoe@email.com",type:"email",autofocus:"",rules:x.email,"error-messages":t(c).email},null,8,["modelValue","rules","error-messages"])]),_:1}),s(u,{cols:"12"},{default:o(()=>[s(i,{modelValue:t(n).password,"onUpdate:modelValue":e[1]||(e[1]=r=>t(n).password=r),label:"Password",placeholder:"············",rules:x.password,type:t(v)?"text":"password",autocomplete:"password","error-messages":t(c).password,"append-inner-icon":t(v)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=r=>v.value=!t(v))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),l("div",ge,[s(te,{id:("useId"in a?a.useId:t(Q))(),modelValue:t(m),"onUpdate:modelValue":e[3]||(e[3]=r=>Y(m)?m.value=r:null),label:"Remember me"},null,8,["id","modelValue"]),s(d,{class:"text-primary ms-2 mb-1",to:{name:"forgot-password"}},{default:o(()=>e[7]||(e[7]=[g(" Forgot Password? ")])),_:1})]),s(X,{block:"",type:"submit"},{default:o(()=>e[8]||(e[8]=[g(" Login ")])),_:1})]),_:1}),s(u,{cols:"12",class:"text-center"},{default:o(()=>[e[10]||(e[10]=l("span",null,"New on our platform?",-1)),s(d,{class:"text-primary ms-1",to:{name:"register"}},{default:o(()=>e[9]||(e[9]=[g(" Create an account ")])),_:1})]),_:1}),s(u,{cols:"12",class:"d-flex align-center"},{default:o(()=>[s(C),e[11]||(e[11]=l("span",{class:"mx-4"},"or",-1)),s(C)]),_:1}),s(u,{cols:"12",class:"text-center"})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{Ae as default};
