import{_ as Ve}from"./4KJD6TD-.js";import{_ as pe}from"./BXxHOZkN.js";import{_ as be}from"./CZmP9VjC.js";import{_ as ke}from"./CEX8y2Ix.js";import{_ as Pe}from"./B__ysSUc.js";import{r as v,d as me,L as ee,w as R,D as ve,I as ae,l as i,a as e,b as n,s as z,x as Ce,q as r,c as I,F as oe,H as se,A as j,v as B,J as L,y as $,o as D,R as we,B as he,C as xe,E as De,K as Ue,N as ie,S as qe,G as $e}from"./BSGE5GTI.js";import{c as ue}from"./BtewNxGx.js";import{u as ge}from"./CkL3z1VM.js";import{u as E}from"./BLyE8agl.js";import{c as Be}from"./DzMSTMj6.js";import{V as fe}from"./D77b0ex7.js";import{V as Se}from"./DF6IzxTq.js";import{V as Ae}from"./CGIYWge0.js";import{V as Te,a as P}from"./BA1Q-Lks.js";import{V as te}from"./Z4zssqwt.js";import{V as de}from"./CL7y6R7f.js";import{V as Fe}from"./DGJLOgtI.js";import{_ as Ne}from"./C8Wvh8wb.js";import{V as Ee}from"./CLLojKmd.js";import{V as ne}from"./CnJXHhAe.js";import{V as Re}from"./BkqMEpij.js";import{V as Ie}from"./DwApywtV.js";import{V as Le,a as ce}from"./CsSRgOlO.js";import{V as Ge}from"./J9FyYICg.js";import"./BFpEfhYG.js";import"./VtgzhqRg.js";import"./D1b0O_WH.js";import"./DVOIMO_o.js";import"./CNo6l2ZD.js";import"./B_ahJWon.js";import"./DiwIzWSr.js";/* empty css        */import"./TnX_cM-C.js";import"./vbOnNZeH.js";import"./276_PEDG.js";const ye=()=>{const A=v([]),U=v(!1);return{packages:A,loadingPackages:U,fetchPackages:async d=>{U.value=!0;try{const{data:c,response:k,error:w}=await E(Be("/packages",d)).json();return A.value=c.value.data||[],{data:c.value,response:k,error:w}}catch(c){return console.error("Error fetching coach:",c),{data:null,response:null,error:c}}finally{U.value=!1}},deletePackage:async d=>await E(`/packages/${d}`,{method:"DELETE"}),deactivatePackage:async d=>await E(`/packages/${d}/deactivate`,{method:"DELETE"}),reactivatePackage:async d=>await E(`/packages/${d}/reactivate`,{method:"PUT"}),storePackage:async d=>await E("/packages").post(d).json(),updatePackage:async(d,c)=>await E(`/packages/${d}`).put(c).json()}},je={class:"text-h4 text-center mb-2"},Oe=["onClick"],Me={class:"pa-2",colspan:"4"},Qe=["onClick"],ze={class:"pa-2",colspan:"4"},He=me({__name:"AddEditPackageDialog",props:{resource:{default:()=>({id:"",project_id:"",name:"",code:"",description:"",price:"",start_at:null,end_at:null,group_credits:"",private_credits:"",credit_validity_days:"",credit_valid_until:"",status:"active",limited_credits:[]})},isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","submit"],setup(A,{emit:U}){const{showSnackbar:p}=we(),x=A,_=U,o=v(x.resource?ue(ee(x.resource)):{id:"",project_id:"",name:"",code:"",description:"",price:"",start_date:null,end_date:null,group_credits:"",private_credits:"",credit_validity_days:"",credit_valid_until_date:"",status:"active",limited_credits:[]}),b=v((o.value.limited_credits??[]).filter(s=>s.course_type==="group")),C=v((o.value.limited_credits??[]).filter(s=>s.course_type==="private")),d=v("");function c(s){const f=s.target.value.replace(/\D/g,"");o.value.price=f,d.value=k(f)}function k(s){return s.replace(/\B(?=(\d{3})+(?!\d))/g,".")}const w=()=>{b.value.push({id:null,course_id:null,credit:"",course_type:"group"})},T=()=>{C.value.push({id:null,course_id:null,credit:"",course_type:"private"})};function H(s){b.value.splice(s,1)}function S(s){C.value.splice(s,1)}R(()=>x.resource,s=>{var l,f;o.value=ue(ee(s)??{id:"",project_id:"",name:"",code:"",description:"",price:"",group_credits:"",private_credits:"",credit_validity_days:"",credit_valid_until:"",status:"active",limited_credits:[]}),o.value.price?d.value=k(parseFloat(o.value.price).toString()):d.value="",b.value=((l=o.value.limited_credits)==null?void 0:l.filter(g=>g.course_type==="group"))??[],C.value=((f=o.value.limited_credits)==null?void 0:f.filter(g=>g.course_type==="private"))??[]},{deep:!0});const V=v({name:void 0,email:void 0,gender:void 0,phone:void 0}),h=v(!1),G=ge(),{groupClasses:J,privateClasses:O}=ve(G);R(()=>x.isDialogVisible,s=>{s&&(G.fetchGroupClasses(""),G.fetchPrivateClasses(""))});const K=()=>{_("update:isDialogVisible",!1),o.value=structuredClone(ee(x.resource))},W=async()=>{try{if(o.value.id){const s=await Y();s!=null&&s.id&&(_("update:isDialogVisible",!1),_("submit",s))}else{const s=await q();s!=null&&s.id&&(_("update:isDialogVisible",!1),_("submit",s))}}catch(s){console.error("Failed to submit form:",s)}},{storePackage:X,updatePackage:M}=ye(),q=async()=>{var s;try{V.value={},h.value=!0,delete o.value.id,o.value.limited_credits=[...b.value,...C.value];const{data:l,error:f,response:g}=await X(o.value);if(f.value){V.value=((s=f.value.data)==null?void 0:s.errors)??{},p(f.value.message,"error"),h.value=!1;return}return h.value=!1,l.value}catch(l){console.error("Failed to delete class:",l)}finally{h.value=!1}},Y=async()=>{var s;try{V.value={},h.value=!0,o.value.limited_credits=[...b.value,...C.value];const{data:l,error:f,response:g}=await M(o.value.id,o.value);if(f.value){V.value=((s=f.value.data)==null?void 0:s.errors)??{},p(f.value.message,"error"),h.value=!1;return}return h.value=!1,l.value}catch(l){console.error("Failed to delete class:",l)}finally{h.value=!1}};return(s,l)=>{const f=Ve,g=pe,F=be,N=ke,Q=Pe;return D(),ae(Fe,{width:s.$vuetify.display.smAndDown?"auto":900,"model-value":x.isDialogVisible,"onUpdate:modelValue":l[10]||(l[10]=u=>s.$emit("update:isDialogVisible",u))},{default:i(()=>[e(f,{onClick:l[0]||(l[0]=u=>s.$emit("update:isDialogVisible",!1))}),e(fe,{class:"pa-2 pa-sm-10"},{default:i(()=>[e(Se,null,{default:i(()=>[n("h4",je,z(x.resource.id?"Edit":"Add New")+" Package ",1),e(Ae,{onSubmit:Ce(W,["prevent"])},{default:i(()=>[e(Te,null,{default:i(()=>[e(P,{cols:"12"},{default:i(()=>[e(g,{modelValue:r(o).name,"onUpdate:modelValue":l[1]||(l[1]=u=>r(o).name=u),label:"Name",placeholder:"Name","error-messages":r(V).name},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"12"},{default:i(()=>[e(te,{text:"Description",class:"mb-1 text-body-2"}),e(F,{modelValue:r(o).description,"onUpdate:modelValue":l[2]||(l[2]=u=>r(o).description=u),class:"border rounded"},null,8,["modelValue"])]),_:1}),e(P,{cols:"6"},{default:i(()=>[e(N,{modelValue:r(o).start_date,"onUpdate:modelValue":l[3]||(l[3]=u=>r(o).start_date=u),label:"Start Date",placeholder:"Date",clearable:"","clear-icon":"tabler-x",style:{"min-width":"150px"},"error-messages":r(V).start_date},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"6"},{default:i(()=>[e(N,{modelValue:r(o).end_date,"onUpdate:modelValue":l[4]||(l[4]=u=>r(o).end_date=u),label:"End Date",placeholder:"Date",clearable:"","clear-icon":"tabler-x",style:{"min-width":"150px"},"error-messages":r(V).end_date},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"6"},{default:i(()=>[e(g,{modelValue:r(o).group_credits,"onUpdate:modelValue":l[5]||(l[5]=u=>r(o).group_credits=u),label:"All Access Group Credit",placeholder:"0",type:"number","error-messages":r(V).group_credits},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"6"},{default:i(()=>[e(g,{modelValue:r(o).private_credits,"onUpdate:modelValue":l[6]||(l[6]=u=>r(o).private_credits=u),label:"All Access Private Credit",placeholder:"0",type:"number","error-messages":r(V).private_credits},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"12"},{default:i(()=>[e(te,{text:"Limited Group Credit",class:"text-body-1"}),e(de,{bordered:"",density:"compact",class:"border"},{default:i(()=>[l[12]||(l[12]=n("thead",null,[n("tr",null,[n("th",null,"#"),n("th",{style:{width:"50%"}},"Class"),n("th",{style:{width:"40%"}},"Credit"),n("th",{style:{width:"10%"}})])],-1)),n("tbody",null,[(D(!0),I(oe,null,se(r(b),(u,a)=>{var t;return D(),I("tr",{key:a},[n("td",null,z(a+1),1),n("td",null,[e(Q,{modelValue:u.course_id,"onUpdate:modelValue":y=>u.course_id=y,placeholder:"Type to search...",items:r(J),clearable:!0,density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),n("td",null,[e(g,{modelValue:u.credit,"onUpdate:modelValue":y=>u.credit=y,placeholder:"0",type:"number",density:"compact","hide-details":"","error-messages":(t=r(V).private_credits)==null?void 0:t[a]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),n("td",{onClick:y=>H(a)},[e(L,{icon:"tabler-trash",class:"text-error"})],8,Oe)])}),128)),n("tr",null,[n("td",Me,[e(j,{onClick:w},{default:i(()=>[e(L,{icon:"tabler-plus",class:"text-white"}),l[11]||(l[11]=B(" Add"))]),_:1})])])])]),_:1})]),_:1}),e(P,{cols:"12"},{default:i(()=>[e(te,{text:"Limited Private Credit",class:"text-body-1"}),e(de,{bordered:"",density:"compact",class:"border"},{default:i(()=>[l[14]||(l[14]=n("thead",null,[n("tr",null,[n("th",null,"#"),n("th",{style:{width:"50%"}},"Class"),n("th",{style:{width:"40%"}},"Credit"),n("th",{style:{width:"10%"}})])],-1)),n("tbody",null,[(D(!0),I(oe,null,se(r(C),(u,a)=>{var t;return D(),I("tr",{key:a},[n("td",null,z(a+1),1),n("td",null,[e(Q,{modelValue:u.course_id,"onUpdate:modelValue":y=>u.course_id=y,placeholder:"Type to search...",items:r(O),clearable:!0,density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),n("td",null,[e(g,{modelValue:u.credit,"onUpdate:modelValue":y=>u.credit=y,placeholder:"0",type:"number",density:"compact","hide-details":"","error-messages":(t=r(V).private_credits)==null?void 0:t[a]},null,8,["modelValue","onUpdate:modelValue","error-messages"])]),n("td",{onClick:y=>S(a)},[e(L,{icon:"tabler-trash",class:"text-error"})],8,Qe)])}),128)),n("tr",null,[n("td",ze,[e(j,{onClick:T},{default:i(()=>[e(L,{icon:"tabler-plus",class:"text-white"}),l[13]||(l[13]=B(" Add"))]),_:1})])])])]),_:1})]),_:1}),e(P,{cols:"12"},{default:i(()=>[e(g,{modelValue:r(o).credit_validity_days,"onUpdate:modelValue":l[7]||(l[7]=u=>r(o).credit_validity_days=u),label:"Credit Valid Days (After Purchase)",placeholder:"0","error-messages":r(V).name},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"12"},{default:i(()=>[e(N,{modelValue:r(o).credit_valid_until_date,"onUpdate:modelValue":l[8]||(l[8]=u=>r(o).credit_valid_until_date=u),label:"Credit Valid Until Date",placeholder:"Date",clearable:"","clear-icon":"tabler-x",style:{"min-width":"150px"}},null,8,["modelValue"])]),_:1}),e(P,{cols:"12"},{default:i(()=>[e(g,{modelValue:r(d),"onUpdate:modelValue":l[9]||(l[9]=u=>$(d)?d.value=u:null),label:"Price (Rp)",placeholder:"0",inputmode:"numeric",autocomplete:"off",onInput:c,"error-messages":r(V).price},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"12",class:"text-center"},{default:i(()=>[e(j,{type:"submit",class:"me-3",loading:r(h)},{default:i(()=>l[15]||(l[15]=[B(" Submit ")])),_:1},8,["loading"]),e(j,{variant:"tonal",color:"secondary",onClick:K},{default:i(()=>l[16]||(l[16]=[B(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),Je={class:"d-flex flex-wrap gap-4 my-4 mx-6"},Ke={class:"d-flex gap-4 flex-wrap align-center"},We={class:"d-flex flex-wrap gap-4 ma-6"},Xe=me({__name:"Packages",setup(A){const U=ge(),p=he(),x=$e(),_=v(p.query.status||void 0),o=v(p.query.q||""),b=v(o.value),C=v([]),d=v(Number(p.query.itemsPerPage)||15),c=v(Number(p.query.page)||1),k=v(p.query.sortBy||void 0),w=v(p.query.orderBy||void 0),T=v({currentPage:c.value,lastPage:1,total:0,perPage:d.value}),H=()=>{console.log("updateQueryParams");const a={...p.query,q:o.value||void 0,status:_.value||void 0,page:c.value!==1?String(c.value):void 0,itemsPerPage:d.value!==15?String(d.value):void 0,sortBy:k.value||void 0,orderBy:w.value||void 0};Object.keys(a).forEach(t=>{a[t]===void 0&&delete a[t]}),x.replace({query:a})};R([o,_,d,c,k,w],()=>{H()}),R(()=>p.query,()=>{(p.query.q!==o.value||p.query.status!==_.value||Number(p.query.page||1)!==c.value||Number(p.query.itemsPerPage||15)!==d.value||p.query.sortBy!==k.value||p.query.orderBy!==w.value)&&(o.value=p.query.q||"",_.value=p.query.status||void 0,c.value=Number(p.query.page)||1,d.value=Number(p.query.itemsPerPage)||15,k.value=p.query.sortBy||void 0,w.value=p.query.orderBy||void 0),q()},{deep:!0});let S=null;R(b,a=>{S&&clearTimeout(S),S=setTimeout(()=>{o.value=a,c.value!==1&&(c.value=1)},500)}),xe(()=>{S&&clearTimeout(S)});const{status:V}=ve(U),h=async()=>{try{G()}catch(a){console.error("Failed to fetch filter options:",a)}},G=()=>{_.value&&!V.value.some(a=>a.value===_.value)&&(_.value="")},J=a=>{var t,y;c.value=a.page,d.value=a.itemsPerPage,a.sortBy&&a.sortBy.length>0?(k.value=(t=a.sortBy[0])==null?void 0:t.key,w.value=(y=a.sortBy[0])==null?void 0:y.order):(k.value=void 0,w.value=void 0)},O=v(null),{fetchPackages:K,deletePackage:W,reactivatePackage:X}=ye(),M=v([]),q=async()=>{const a={q:o.value,status:_.value,page:c.value,per_page:d.value,sort_by:k.value,order_by:w.value},{data:t,response:y,error:Z}=await K({query:a});return M.value=t.data,O.value=t,{data:t,response:y,error:Z}};R(O,a=>{a&&(T.value={currentPage:a.current_page,lastPage:a.last_page,total:a.total,perPage:a.per_page},c.value=a.current_page,d.value=a.per_page)},{deep:!0});const Y=[{title:"Name",key:"name"},{title:"Start",key:"start_date"},{title:"End",key:"end_date"},{title:"Group C.",key:"group_credits"},{title:"Private C.",key:"private_credits"},{title:"Vaild Days",key:"credit_validity_days"},{title:"Vaild Until",key:"credit_valid_until_date"},{title:"Price",key:"price"},{title:"Status",key:"status",sortable:!1,align:"end",width:100},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"100px"}],s=a=>{if(a==="active")return{text:"Active",color:"success"};if(a==="inactive")return{text:"Inactive",color:"error"}},l=async a=>{try{await W(a),q()}catch(t){console.error("Failed to delete class:",t)}},f=async a=>{try{await X(a),q()}catch(t){console.error("Failed to delete class:",t)}};De(async()=>{await q(),await h()});const g=v(!1),F=v(!1),N=v(null),Q=a=>{N.value=a,F.value=!0};function u(a){const t=parseFloat(a);return isNaN(t)?a:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}return(a,t)=>{const y=He,Z=pe,le=Ue("IconBtn"),_e=Ne;return D(),I("div",null,[e(fe,null,{default:i(()=>[n("div",Je,[t[11]||(t[11]=n("div",{class:"font-weight-medium text-lg align-self-center"},"Package",-1)),e(Ee),n("div",Ke,[e(j,{color:"primary","prepend-icon":"tabler-plus",onClick:t[0]||(t[0]=()=>{g.value=!0})},{default:i(()=>t[10]||(t[10]=[B(" Add Package ")])),_:1}),e(y,{"is-dialog-visible":r(g),"onUpdate:isDialogVisible":t[1]||(t[1]=m=>$(g)?g.value=m:null),onSubmit:t[2]||(t[2]=m=>q())},null,8,["is-dialog-visible"]),e(y,{"is-dialog-visible":r(F),"onUpdate:isDialogVisible":t[3]||(t[3]=m=>$(F)?F.value=m:null),resource:r(N),onSubmit:t[4]||(t[4]=m=>q())},null,8,["is-dialog-visible","resource"])])]),e(ne),n("div",We,[e(Z,{modelValue:r(b),"onUpdate:modelValue":t[5]||(t[5]=m=>$(b)?b.value=m:null),placeholder:"Search",clearable:""},null,8,["modelValue"])]),e(ne,{class:"mt-4"}),e(Re,{"items-per-page":r(d),"onUpdate:itemsPerPage":t[7]||(t[7]=m=>$(d)?d.value=m:null),"model-value":r(C),"onUpdate:modelValue":t[8]||(t[8]=m=>$(C)?C.value=m:null),page:r(c),"onUpdate:page":t[9]||(t[9]=m=>$(c)?c.value=m:null),headers:Y,"show-select":"",items:r(M),"items-length":r(T).total,class:"text-no-wrap","onUpdate:options":J},{"item.price":i(({item:m})=>[B(z(u(m.price)),1)]),"item.status":i(({item:m})=>[e(Ge,qe(s(m.status??""),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":i(({item:m})=>[e(le,{onClick:re=>Q(m)},{default:i(()=>[e(L,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(le,null,{default:i(()=>[e(L,{icon:"tabler-dots-vertical"}),e(Ie,{activator:"parent"},{default:i(()=>[e(Le,null,{default:i(()=>[m.status==="active"?(D(),ae(ce,{key:0,value:"delete","prepend-icon":"tabler-x",onClick:re=>l(m.id),"base-color":"error"},{default:i(()=>t[12]||(t[12]=[B(" Deactive ")])),_:2},1032,["onClick"])):ie("",!0),m.status==="inactive"?(D(),ae(ce,{key:1,value:"reactivate","prepend-icon":"tabler-check",onClick:re=>f(m.id),"base-color":"success"},{default:i(()=>t[13]||(t[13]=[B(" Activate ")])),_:2},1032,["onClick"])):ie("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:i(()=>[e(_e,{page:r(c),"onUpdate:page":t[6]||(t[6]=m=>$(c)?c.value=m:null),"items-per-page":r(T).perPage,"total-items":r(T).total},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}}),At={__name:"index",setup(A){return(U,p)=>(D(),I("div",null,[e(Xe)]))}};export{At as default};
