import{_ as S}from"./BXxHOZkN.js";import{d as F,r as l,I as q,l as t,a,q as r,y as v,b as B,c as $,F as L,H as T,A as P,x as C,v as g,o as x,J as U,R as z,_ as E}from"./BSGE5GTI.js";import{u as M}from"./BLyE8agl.js";import{a as f,V as b}from"./BA1Q-Lks.js";import{V as j}from"./D77b0ex7.js";import{V as H}from"./CGIYWge0.js";import{V as y}from"./DF6IzxTq.js";import{V as J,a as O}from"./CsSRgOlO.js";const D=F({__name:"Security",setup(G){const{showSnackbar:w}=z(),i=l(!1),u=l(!1),p=l(!1),m=l(""),d=l(""),c=l(""),k=["Minimum 8 characters long - the more, the better","At least one lowercase character","At least one number, symbol, or whitespace character"],h=[s=>!!s||"New password is required",s=>s.length>=8||"Password must be at least 8 characters long",s=>/[a-z]/.test(s)||"Password must contain at least one lowercase letter",s=>/[0-9!@#$%^&*(),.?":{}|<>]/.test(s)||"Password must contain at least one number or special character"],R=[s=>!!s||"Confirm password is required",s=>s===d.value||"Passwords do not match"],V=l();async function A(){const{valid:s}=await V.value.validate();return s}function _(){V.value.reset()}const I=async()=>{var s,e;if(await A())try{const{data:n,response:o,error:N}=await M("/change-password").post({current_password:m.value,password:d.value,password_confirmation:c.value}).json();if(!((s=o.value)!=null&&s.ok)){w(((e=N.value)==null?void 0:e.message)||"Failed Changing Password","error");return}_(),w(n.value.message,"success")}catch(n){console.log("Error",n),w("Oops Something went wrong : "+n,"error")}};return(s,e)=>{const n=S;return x(),q(b,null,{default:t(()=>[a(f,{cols:"12"},{default:t(()=>[a(j,{title:"Change Password"},{default:t(()=>[a(H,{ref_key:"form",ref:V},{default:t(()=>[a(y,{class:"pt-0"},{default:t(()=>[a(b,null,{default:t(()=>[a(f,{cols:"12",md:"6"},{default:t(()=>[a(n,{modelValue:r(m),"onUpdate:modelValue":e[0]||(e[0]=o=>v(m)?m.value=o:null),type:r(i)?"text":"password","append-inner-icon":r(i)?"tabler-eye-off":"tabler-eye",label:"Current Password",autocomplete:"on",placeholder:"············","onClick:appendInner":e[1]||(e[1]=o=>i.value=!r(i))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),a(b,null,{default:t(()=>[a(f,{cols:"12",md:"6"},{default:t(()=>[a(n,{modelValue:r(d),"onUpdate:modelValue":e[2]||(e[2]=o=>v(d)?d.value=o:null),type:r(u)?"text":"password","append-inner-icon":r(u)?"tabler-eye-off":"tabler-eye",rules:h,label:"New Password",autocomplete:"on",placeholder:"············","onClick:appendInner":e[3]||(e[3]=o=>u.value=!r(u))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),a(f,{cols:"12",md:"6"},{default:t(()=>[a(n,{modelValue:r(c),"onUpdate:modelValue":e[4]||(e[4]=o=>v(c)?c.value=o:null),type:r(p)?"text":"password","append-inner-icon":r(p)?"tabler-eye-off":"tabler-eye",label:"Confirm New Password",autocomplete:"on",rules:R,placeholder:"············","onClick:appendInner":e[5]||(e[5]=o=>p.value=!r(p))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1})]),_:1}),a(y,null,{default:t(()=>[e[6]||(e[6]=B("h6",{class:"text-h6 text-medium-emphasis mb-4"}," Password Requirements: ",-1)),a(J,{class:"card-list"},{default:t(()=>[(x(),$(L,null,T(k,o=>a(O,{key:o,title:o,class:"text-medium-emphasis"},{prepend:t(()=>[a(U,{size:"10",icon:"tabler-circle-filled"})]),_:2},1032,["title"])),64))]),_:1})]),_:1}),a(y,{class:"d-flex flex-wrap gap-4"},{default:t(()=>[a(P,{onClick:C(I,["prevent"])},{default:t(()=>e[7]||(e[7]=[g("Save changes")])),_:1}),a(P,{type:"reset",color:"secondary",variant:"tonal",onClick:C(_,["prevent"])},{default:t(()=>e[8]||(e[8]=[g(" Reset ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})}}}),se=E(D,[["__scopeId","data-v-f4252dff"]]);export{se as A};
