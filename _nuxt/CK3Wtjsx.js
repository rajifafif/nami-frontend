import{_ as de}from"./CUEYP4dV.js";import{A as me}from"./CnauD-Ne.js";import{_ as ce}from"./4KJD6TD-.js";import{_ as ee}from"./BXxHOZkN.js";import{_ as pe}from"./B__ysSUc.js";import{r as c,d as K,L as Q,w as U,D as te,I as fe,l as o,a as e,b as T,s as ae,x as ve,q as s,y,A as W,v as A,o as I,B as ge,C as ye,E as be,c as j,K as Ve,J as F,S as _e,z as Se,G as we,f as Pe,i as qe,F as xe,H as Be}from"./BSGE5GTI.js";import{u as le}from"./CkL3z1VM.js";import{u as k}from"./BLyE8agl.js";import{c as he}from"./DzMSTMj6.js";import{V as oe}from"./D77b0ex7.js";import{V as Ce}from"./DF6IzxTq.js";import{V as ke}from"./CGIYWge0.js";import{V as Ue,a as B}from"./BA1Q-Lks.js";import{V as Te}from"./DGJLOgtI.js";import{_ as Ae}from"./Dy-GdebM.js";import{_ as $e}from"./C8Wvh8wb.js";import{V as De}from"./CLLojKmd.js";import{V as Y}from"./CnJXHhAe.js";import{V as Ee}from"./BkqMEpij.js";import{V as Ne}from"./DwApywtV.js";import{V as Re,a as Fe}from"./CsSRgOlO.js";import{V as Ie}from"./J9FyYICg.js";import{V as ze}from"./DIFYFz4Q.js";import{V as Ge}from"./CNo6l2ZD.js";import{V as Le,a as Me}from"./BHiJbfg-.js";import{V as Oe,a as Z}from"./aeahcXnz.js";import"./Z4zssqwt.js";import"./BFpEfhYG.js";import"./VtgzhqRg.js";import"./D1b0O_WH.js";import"./DVOIMO_o.js";import"./B_ahJWon.js";import"./DiwIzWSr.js";/* empty css        */import"./TnX_cM-C.js";import"./CL7y6R7f.js";import"./vbOnNZeH.js";import"./276_PEDG.js";const se=()=>{const q=c([]),b=c(!1);return{staffs:q,loadingStaffs:b,fetchStaffs:async r=>{b.value=!0;try{const{data:m,response:u,error:v}=await k(he("/staffs",r)).json();return q.value=m.value.data||[],{data:m.value,response:u,error:v}}catch(m){return console.error("Error fetching staff:",m),{data:null,response:null,error:m}}finally{b.value=!1}},deleteStaff:async r=>await k(`/staffs/${r}`,{method:"DELETE"}),reactivateStaff:async r=>await k(`/staffs/${r}/reactivate`,{method:"PUT"}),storeStaff:async r=>await k("/staffs",{method:"POST"}),updateStaff:async(r,m)=>await k(`/staffs/${r}`,{method:"PUT"})}},Qe={class:"text-h4 text-center mb-2"},We=K({__name:"AddEditStaffDialog",props:{resource:{default:()=>({id:"",owner_id:"",name_prefix:"",name:"",name_suffix:"",gender:null,birth_date:"",birth_place:"",default_address_id:"",email:"",phone:"",user_id:"",user:""})},isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","submit"],setup(q,{emit:b}){const l=q,w=b,n=c(structuredClone(Q(l.resource)));U(()=>l.resource,g=>{n.value=structuredClone(Q(g))},{deep:!0});const p=()=>{w("update:isDialogVisible",!1),n.value=structuredClone(Q(l.resource))},_=async()=>{n.value.id?await M():await $(),w("update:isDialogVisible",!1),w("submit",n.value)},r=le(),{status:m,genders:u}=te(r),v=c(""),V=c([]),{fetchWilayah:x}=r,z=async()=>{x(v.value).then(({data:g})=>{console.log("ss",g.value.data),V.value=g.value.data})},S=c(null),{storeStaff:G,updateStaff:L}=se(),$=async()=>{try{await G(n.value)}catch(g){console.error("Failed to delete class:",g)}},M=async()=>{try{await L(n.value.id,n.value)}catch(g){console.error("Failed to delete class:",g)}};return(g,d)=>{const h=ce,C=ee,D=pe;return I(),fe(Te,{width:g.$vuetify.display.smAndDown?"auto":900,"model-value":l.isDialogVisible,"onUpdate:modelValue":d[6]||(d[6]=f=>g.$emit("update:isDialogVisible",f))},{default:o(()=>[e(h,{onClick:d[0]||(d[0]=f=>g.$emit("update:isDialogVisible",!1))}),e(oe,{class:"pa-2 pa-sm-10"},{default:o(()=>[e(Ce,null,{default:o(()=>[T("h4",Qe,ae(l.resource.id?"Edit":"Add New")+" Staff ",1),e(ke,{onSubmit:ve(_,["prevent"])},{default:o(()=>[e(Ue,null,{default:o(()=>[e(B,{cols:"12"},{default:o(()=>[e(C,{modelValue:s(n).name,"onUpdate:modelValue":d[1]||(d[1]=f=>s(n).name=f),label:"Name",placeholder:"Full Name"},null,8,["modelValue"])]),_:1}),e(B,{cols:"12"},{default:o(()=>[e(D,{modelValue:s(n).gender,"onUpdate:modelValue":d[2]||(d[2]=f=>s(n).gender=f),label:"Select Gender",placeholder:"Select Gender",items:s(u),clearable:!0},null,8,["modelValue","items"])]),_:1}),e(B,{cols:"12"},{default:o(()=>[e(C,{modelValue:s(n).email,"onUpdate:modelValue":d[3]||(d[3]=f=>s(n).email=f),label:"E-Mail",placeholder:"user@gmail.com"},null,8,["modelValue"])]),_:1}),e(B,{cols:"12"},{default:o(()=>[e(C,{label:"Password (default)",placeholder:"password",disabled:""})]),_:1}),e(B,{cols:"12"},{default:o(()=>[e(D,{modelValue:s(S),"onUpdate:modelValue":d[4]||(d[4]=f=>y(S)?S.value=f:null),search:s(v),"onUpdate:search":[d[5]||(d[5]=f=>y(v)?v.value=f:null),z],items:s(V),"no-filter":"",label:"Select Kecamatan",placeholder:"Type to search...","item-title":"full_name","item-value":"kelurahan_id",clearable:!0},null,8,["modelValue","search","items"])]),_:1}),e(B,{cols:"12",class:"text-center"},{default:o(()=>[e(W,{type:"submit",class:"me-3"},{default:o(()=>d[7]||(d[7]=[A(" Submit ")])),_:1}),e(W,{variant:"tonal",color:"secondary",onClick:p},{default:o(()=>d[8]||(d[8]=[A(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),je={class:"d-flex flex-wrap gap-4 my-4 mx-6"},Ke={class:"d-flex gap-4 flex-wrap align-center"},He={class:"d-flex flex-wrap gap-4 ma-6"},Je=K({__name:"Staff",setup(q){const b=le(),l=ge(),w=we(),n=c(l.query.status||void 0),p=c(l.query.q||""),_=c(p.value),r=c([]),m=c(Number(l.query.itemsPerPage)||15),u=c(Number(l.query.page)||1),v=c(l.query.sortBy||void 0),V=c(l.query.orderBy||void 0),x=c({currentPage:u.value,lastPage:1,total:0,perPage:m.value}),z=()=>{console.log("updateQueryParams");const t={...l.query,q:p.value||void 0,status:n.value||void 0,page:u.value!==1?String(u.value):void 0,itemsPerPage:m.value!==15?String(m.value):void 0,sortBy:v.value||void 0,orderBy:V.value||void 0};Object.keys(t).forEach(a=>{t[a]===void 0&&delete t[a]}),w.replace({query:t})};U([p,n,m,u,v,V],()=>{z()}),U(()=>l.query,()=>{(l.query.q!==p.value||l.query.status!==n.value||Number(l.query.page||1)!==u.value||Number(l.query.itemsPerPage||15)!==m.value||l.query.sortBy!==v.value||l.query.orderBy!==V.value)&&(p.value=l.query.q||"",n.value=l.query.status||void 0,u.value=Number(l.query.page)||1,m.value=Number(l.query.itemsPerPage)||15,v.value=l.query.sortBy||void 0,V.value=l.query.orderBy||void 0),h()},{deep:!0});let S=null;U(_,t=>{S&&clearTimeout(S),S=setTimeout(()=>{p.value=t,u.value!==1&&(u.value=1)},500)}),ye(()=>{S&&clearTimeout(S)});const{status:G}=te(b),L=t=>{var a,P;u.value=t.page,m.value=t.itemsPerPage,t.sortBy&&t.sortBy.length>0?(v.value=(a=t.sortBy[0])==null?void 0:a.key,V.value=(P=t.sortBy[0])==null?void 0:P.order):(v.value=void 0,V.value=void 0)},$=c(null),{fetchStaffs:M,deleteStaff:g}=se(),d=c([]),h=async()=>{const t={q:p.value,status:n.value,page:u.value,per_page:m.value,sort_by:v.value,order_by:V.value},{data:a,response:P,error:O}=await M({query:t});return d.value=a.data,$.value=a,{data:a,response:P,error:O}};U($,t=>{t&&(x.value={currentPage:t.current_page,lastPage:t.last_page,total:t.total,perPage:t.per_page},u.value=t.current_page,m.value=t.per_page)},{deep:!0});const C=[{title:"Name",key:"name",sortable:!0,align:"start"},{title:"E-Mail",key:"email",sortable:!0,align:"start"},{title:"Phone",key:"phone",sortable:!0,align:"start"},{title:"Gender",key:"gender",sortable:!0,align:"center"},{title:"Status",key:"status",sortable:!1,align:"end",width:100},{title:"Actions",key:"actions",sortable:!1,align:"end",width:100}],D=t=>{if(t==="active")return{text:"Active",color:"success"};if(t==="inactive")return{text:"Inactive",color:"error"}},f=t=>{if(t==="M")return{color:"primary",icon:"tabler-mars"};if(t==="F")return{color:"error",icon:"tabler-venus"}},re=async t=>{try{await g(t),h()}catch(a){console.error("Failed to delete class:",a)}};be(async()=>{await h()});const E=c(!1),N=c(!1),H=c(null),ie=t=>{H.value=t,N.value=!0};return(t,a)=>{const P=We,O=ee,ne=Ae,J=Ve("IconBtn"),ue=$e;return I(),j("div",null,[e(oe,null,{default:o(()=>[T("div",je,[a[10]||(a[10]=T("div",{class:"font-weight-medium text-lg align-self-center"},"Staff",-1)),e(De),T("div",Ke,[e(W,{color:"primary","prepend-icon":"tabler-plus",onClick:a[0]||(a[0]=()=>{E.value=!0})},{default:o(()=>a[9]||(a[9]=[A(" Add Staff ")])),_:1}),e(P,{"is-dialog-visible":s(E),"onUpdate:isDialogVisible":a[1]||(a[1]=i=>y(E)?E.value=i:null)},null,8,["is-dialog-visible"]),e(P,{"is-dialog-visible":s(N),"onUpdate:isDialogVisible":a[2]||(a[2]=i=>y(N)?N.value=i:null),resource:s(H)},null,8,["is-dialog-visible","resource"])])]),e(Y),T("div",He,[e(O,{modelValue:s(_),"onUpdate:modelValue":a[3]||(a[3]=i=>y(_)?_.value=i:null),placeholder:"Search",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue"]),e(ne,{modelValue:s(n),"onUpdate:modelValue":a[4]||(a[4]=i=>y(n)?n.value=i:null),placeholder:"Status",items:s(G),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),e(Y,{class:"mt-4"}),e(Ee,{"items-per-page":s(m),"onUpdate:itemsPerPage":a[6]||(a[6]=i=>y(m)?m.value=i:null),"model-value":s(r),"onUpdate:modelValue":a[7]||(a[7]=i=>y(r)?r.value=i:null),page:s(u),"onUpdate:page":a[8]||(a[8]=i=>y(u)?u.value=i:null),headers:C,"show-select":"",items:s(d),"items-length":s(x).total,class:"text-no-wrap","onUpdate:options":L},{"item.gender":o(({item:i})=>{var R;return[e(Ge,{size:"30",variant:"tonal",color:(R=f(i.gender))==null?void 0:R.color,class:"me-4"},{default:o(()=>{var X;return[e(F,{icon:(X=f(i.gender))==null?void 0:X.icon,size:"18"},null,8,["icon"])]}),_:2},1032,["color"])]}),"item.stock":o(({item:i})=>[e(ze,{id:("useId"in t?t.useId:s(Se))(),"model-value":i.name},null,8,["id","model-value"])]),"item.status":o(({item:i})=>[e(Ie,_e(D(i.status),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":o(({item:i})=>[e(J,{onClick:R=>ie(i)},{default:o(()=>[e(F,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(J,null,{default:o(()=>[e(F,{icon:"tabler-dots-vertical"}),e(Ne,{activator:"parent"},{default:o(()=>[e(Re,null,{default:o(()=>[e(Fe,{value:"delete","prepend-icon":"tabler-trash",onClick:R=>re(i.id)},{default:o(()=>a[11]||(a[11]=[A(" Delete ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:o(()=>[e(ue,{page:s(u),"onUpdate:page":a[5]||(a[5]=i=>y(u)?u.value=i:null),"items-per-page":s(x).perPage,"total-items":s(x).total},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}}),Et=K({__name:"[tab]",setup(q){const b=Pe(),l=qe({get:()=>b.params.tab,set:()=>b.params.tab}),w=[{title:"Staff",icon:"tabler-users",tab:"staff"},{title:"Permission",icon:"tabler-lock",tab:"permission"}];return(n,p)=>{const _=de;return I(),j("div",null,[e(Le,{modelValue:s(l),"onUpdate:modelValue":p[0]||(p[0]=r=>y(l)?l.value=r:null),class:"v-tabs-pill"},{default:o(()=>[(I(),j(xe,null,Be(w,r=>e(Me,{key:r.icon,value:r.tab,to:{name:"users-tab",params:{tab:r.tab}}},{default:o(()=>[e(F,{size:"20",start:"",icon:r.icon},null,8,["icon"]),A(" "+ae(r.title),1)]),_:2},1032,["value","to"])),64))]),_:1},8,["modelValue"]),e(_,null,{default:o(()=>[e(Oe,{modelValue:s(l),"onUpdate:modelValue":p[1]||(p[1]=r=>y(l)?l.value=r:null),class:"mt-6 disable-tab-transition",touch:!1},{default:o(()=>[e(Z,{value:"staff"},{default:o(()=>[e(Je)]),_:1}),e(Z,{value:"permission"},{default:o(()=>[e(me)]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});export{Et as default};
