import{_ as me}from"./4KJD6TD-.js";import{_ as ve}from"./B__ysSUc.js";import{_ as ge}from"./CEX8y2Ix.js";import{_ as le}from"./BXxHOZkN.js";import{r as m,d as re,L as O,w as V,D as se,M as W,I as Q,l as n,a as l,b as U,x as fe,q as u,y as b,A as G,v as $,o as F,R as ye,B as _e,C as be,E as ke,c as oe,K as Ve,J as X,N as Z,S as Pe,s as De,G as we}from"./BSGE5GTI.js";import{c as ee}from"./BtewNxGx.js";import{u as S}from"./BLyE8agl.js";import{c as xe}from"./DzMSTMj6.js";import{u as ie}from"./CkL3z1VM.js";import{V as ue}from"./D77b0ex7.js";import{V as qe}from"./DF6IzxTq.js";import{V as Ce}from"./CGIYWge0.js";import{V as Ae,a as x}from"./BA1Q-Lks.js";import{V as Be}from"./DGJLOgtI.js";import{_ as Se}from"./C8Wvh8wb.js";import{V as Ue}from"./CLLojKmd.js";import{V as ae}from"./CnJXHhAe.js";import{V as $e}from"./BkqMEpij.js";import{V as Te}from"./DwApywtV.js";import{V as Ne,a as te}from"./CsSRgOlO.js";import{V as Ee}from"./J9FyYICg.js";import"./Z4zssqwt.js";import"./VtgzhqRg.js";import"./BFpEfhYG.js";import"./D1b0O_WH.js";import"./DVOIMO_o.js";import"./CNo6l2ZD.js";import"./B_ahJWon.js";import"./DiwIzWSr.js";/* empty css        */import"./TnX_cM-C.js";import"./CL7y6R7f.js";import"./vbOnNZeH.js";import"./276_PEDG.js";const ne=()=>{const q=m([]),k=m(!1);return{applyPackages:q,loadingPackages:k,fetchPackages:async i=>{k.value=!0;try{const{data:s,response:g,error:f}=await S(xe("/apply-packages",i)).json();return q.value=s.value.data||[],{data:s.value,response:g,error:f}}catch(s){return console.error("Error fetching coach:",s),{data:null,response:null,error:s}}finally{k.value=!1}},deletePackage:async i=>await S(`/apply-packages/${i}`,{method:"DELETE"}),deactivatePackage:async i=>await S(`/apply-packages/${i}/deactivate`,{method:"DELETE"}),reactivatePackage:async i=>await S(`/apply-packages/${i}/reactivate`,{method:"PUT"}),storePackage:async i=>await S("/apply-packages").post(i).json(),updatePackage:async(i,s)=>await S(`/apply-packages/${i}`).put(s).json()}},Fe=re({__name:"AddEditApplyPackageDialog",props:{resource:{default:()=>({id:"",project_id:"",name:"",code:"",description:"",price:"",start_at:null,end_at:null,group_credits:"",private_credits:"",credit_validity_days:"",credit_valid_until:"",status:"active"})},isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","submit"],setup(q,{emit:k}){const{showSnackbar:d}=ye(),_=q,v=k,t=m(_.resource?ee(O(_.resource)):{id:"",project_id:"",name:"",code:"",description:"",price:"",start_date:null,end_date:null,group_credits:"",private_credits:"",credit_validity_days:"",credit_valid_until_date:"",status:"active"}),P=m("");function C(o){return o.replace(/\B(?=(\d{3})+(?!\d))/g,".")}V(()=>_.resource,o=>{t.value=ee(O(o)??{id:"",project_id:"",name:"",code:"",description:"",price:"",group_credits:"",private_credits:"",credit_validity_days:"",credit_valid_until:"",status:"active"}),P.value=C(parseFloat(t.value.price).toString())},{deep:!0});const i=m({name:void 0,email:void 0,gender:void 0,phone:void 0}),s=m(!1),g=()=>{v("update:isDialogVisible",!1),t.value=structuredClone(O(_.resource))},f=async()=>{try{if(t.value.id){const o=await z();o!=null&&o.id&&(v("update:isDialogVisible",!1),v("submit",o))}else{const o=await D();o!=null&&o.id&&(v("update:isDialogVisible",!1),v("submit",o))}}catch(o){console.error("Failed to submit form:",o)}},{storePackage:A,updatePackage:j}=ne(),D=async()=>{var o;try{i.value={},s.value=!0,delete t.value.id;const{data:a,error:y,response:B}=await A(t.value);if(y.value){i.value=((o=y.value.data)==null?void 0:o.errors)??{},d(y.value.message,"error"),s.value=!1;return}return s.value=!1,a.value}catch(a){console.error("Failed to delete class:",a)}finally{s.value=!1}},z=async()=>{var o;try{i.value={},s.value=!0;const{data:a,error:y,response:B}=await j(t.value.id,t.value);if(y.value){i.value=((o=y.value.data)==null?void 0:o.errors)??{},d(y.value.message,"error"),s.value=!1;return}return s.value=!1,a.value}catch(a){console.error("Failed to delete class:",a)}finally{s.value=!1}},T=ie(),{members:R,packages:Y}=se(T),N=m(""),E=m("");return V(()=>_.isDialogVisible,o=>{o&&(T.fetchOptions("packages","/options/packages"),T.fetchOptions("members","/options/members"))},{immediate:!0}),V(()=>t.value.package_id,o=>{o&&(t.value.group_credits=10,t.value.private_credits=5),o&&t.value.start_date&&(t.value.credit_valid_until_date=W(t.value.start_date).add(30,"days").format("YYYY-MM-DD"))},{immediate:!0}),V(()=>t.value.start_date,o=>{o&&t.value.package_id&&(t.value.credit_valid_until_date=W(t.value.start_date).add(30,"days").format("YYYY-MM-DD"))},{immediate:!0}),(o,a)=>{const y=me,B=ve,I=ge,M=le;return F(),Q(Be,{width:o.$vuetify.display.smAndDown?"auto":900,"model-value":_.isDialogVisible,"onUpdate:modelValue":a[9]||(a[9]=p=>o.$emit("update:isDialogVisible",p))},{default:n(()=>[l(y,{onClick:a[0]||(a[0]=p=>o.$emit("update:isDialogVisible",!1))}),l(ue,{class:"pa-2 pa-sm-10"},{default:n(()=>[l(qe,null,{default:n(()=>[a[13]||(a[13]=U("h4",{class:"text-h4 text-center mb-2"}," Apply Package ",-1)),l(Ce,{onSubmit:fe(f,["prevent"])},{default:n(()=>[l(Ae,null,{default:n(()=>[l(x,{cols:"12"},{default:n(()=>[l(B,{modelValue:u(t).member_id,"onUpdate:modelValue":a[1]||(a[1]=p=>u(t).member_id=p),search:u(E),"onUpdate:search":a[2]||(a[2]=p=>b(E)?E.value=p:null),label:"Select Member",placeholder:"Type to search...",items:u(R),clearable:!0,"item-title":"title","item-value":"value"},null,8,["modelValue","search","items"])]),_:1}),l(x,{cols:"12"},{default:n(()=>[l(B,{modelValue:u(t).package_id,"onUpdate:modelValue":a[3]||(a[3]=p=>u(t).package_id=p),search:u(N),"onUpdate:search":a[4]||(a[4]=p=>b(N)?N.value=p:null),label:"Select Package",placeholder:"Type to search...",items:u(Y),clearable:!0,"item-title":"title","item-value":"value"},null,8,["modelValue","search","items"])]),_:1}),l(x,{cols:"12"},{default:n(()=>[l(I,{modelValue:u(t).start_date,"onUpdate:modelValue":a[5]||(a[5]=p=>u(t).start_date=p),label:"Start Date",placeholder:"Date",clearable:"","clear-icon":"tabler-x",style:{"min-width":"150px"},"error-messages":u(i).start_date},null,8,["modelValue","error-messages"])]),_:1}),l(x,{cols:"6"},{default:n(()=>[l(M,{modelValue:u(t).group_credits,"onUpdate:modelValue":a[6]||(a[6]=p=>u(t).group_credits=p),label:"All Access Group Credit",placeholder:"0",type:"number",disabled:"","error-messages":u(i).group_credits},null,8,["modelValue","error-messages"])]),_:1}),l(x,{cols:"6"},{default:n(()=>[l(M,{modelValue:u(t).private_credits,"onUpdate:modelValue":a[7]||(a[7]=p=>u(t).private_credits=p),label:"All Access Private Credit",placeholder:"0",type:"number",disabled:"","error-messages":u(i).private_credits},null,8,["modelValue","error-messages"])]),_:1}),a[12]||(a[12]=U("div",null,null,-1)),l(x,{cols:"12"},{default:n(()=>[l(I,{modelValue:u(t).credit_valid_until_date,"onUpdate:modelValue":a[8]||(a[8]=p=>u(t).credit_valid_until_date=p),label:"Credit Valid Until Date",placeholder:"Date",clearable:"",disabled:"","clear-icon":"tabler-x",style:{"min-width":"150px"}},null,8,["modelValue"])]),_:1}),l(x,{cols:"12",class:"text-center"},{default:n(()=>[l(G,{type:"submit",class:"me-3",loading:u(s)},{default:n(()=>a[10]||(a[10]=[$(" Submit ")])),_:1},8,["loading"]),l(G,{variant:"tonal",color:"secondary",onClick:g},{default:n(()=>a[11]||(a[11]=[$(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),Re={class:"d-flex flex-wrap gap-4 my-4 mx-6"},Ie={class:"d-flex gap-4 flex-wrap align-center"},Me={class:"d-flex flex-wrap gap-4 ma-6"},he=re({__name:"ApplyPackage",setup(q){const k=ie(),d=_e(),_=we(),v=m(d.query.status||void 0),t=m(d.query.q||""),P=m(t.value),C=m([]),i=m(Number(d.query.itemsPerPage)||15),s=m(Number(d.query.page)||1),g=m(d.query.sortBy||void 0),f=m(d.query.orderBy||void 0),A=m({currentPage:s.value,lastPage:1,total:0,perPage:i.value}),j=()=>{console.log("updateQueryParams");const r={...d.query,q:t.value||void 0,status:v.value||void 0,page:s.value!==1?String(s.value):void 0,itemsPerPage:i.value!==15?String(i.value):void 0,sortBy:g.value||void 0,orderBy:f.value||void 0};Object.keys(r).forEach(e=>{r[e]===void 0&&delete r[e]}),_.replace({query:r})};V([t,v,i,s,g,f],()=>{j()}),V(()=>d.query,()=>{(d.query.q!==t.value||d.query.status!==v.value||Number(d.query.page||1)!==s.value||Number(d.query.itemsPerPage||15)!==i.value||d.query.sortBy!==g.value||d.query.orderBy!==f.value)&&(t.value=d.query.q||"",v.value=d.query.status||void 0,s.value=Number(d.query.page)||1,i.value=Number(d.query.itemsPerPage)||15,g.value=d.query.sortBy||void 0,f.value=d.query.orderBy||void 0),a()},{deep:!0});let D=null;V(P,r=>{D&&clearTimeout(D),D=setTimeout(()=>{t.value=r,s.value!==1&&(s.value=1)},500)}),be(()=>{D&&clearTimeout(D)});const{status:z}=se(k),T=r=>{var e,w;s.value=r.page,i.value=r.itemsPerPage,r.sortBy&&r.sortBy.length>0?(g.value=(e=r.sortBy[0])==null?void 0:e.key,f.value=(w=r.sortBy[0])==null?void 0:w.order):(g.value=void 0,f.value=void 0)},R=m(null),{fetchPackages:Y,deletePackage:N,reactivatePackage:E}=ne(),o=m([]),a=async()=>{const r={q:t.value,status:v.value,page:s.value,per_page:i.value,sort_by:g.value,order_by:f.value},{data:e,response:w,error:L}=await Y({query:r});return o.value=e.data,R.value=e,{data:e,response:w,error:L}};V(R,r=>{r&&(A.value={currentPage:r.current_page,lastPage:r.last_page,total:r.total,perPage:r.per_page},s.value=r.current_page,i.value=r.per_page)},{deep:!0});const y=[{title:"Name",key:"name"},{title:"Start",key:"start_date"},{title:"End",key:"end_date"},{title:"Group C.",key:"group_credits"},{title:"Private C.",key:"private_credits"},{title:"Vaild Days",key:"credit_validity_days"},{title:"Vaild Until",key:"credit_valid_until_date"},{title:"Price",key:"price"},{title:"Status",key:"status",sortable:!1,align:"end",width:100},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"100px"}],B=r=>{if(r==="active")return{text:"Active",color:"success"};if(r==="inactive")return{text:"Inactive",color:"error"}},I=async r=>{try{await N(r),a()}catch(e){console.error("Failed to delete class:",e)}},M=async r=>{try{await E(r),a()}catch(e){console.error("Failed to delete class:",e)}};ke(async()=>{await a()});const p=m(!1),h=m(!1),J=m(null),de=r=>{J.value=r,h.value=!0};function ce(r){const e=parseFloat(r);return isNaN(e)?r:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}return(r,e)=>{const w=Fe,L=le,K=Ve("IconBtn"),pe=Se;return F(),oe("div",null,[l(ue,null,{default:n(()=>[U("div",Re,[e[11]||(e[11]=U("div",{class:"font-weight-medium text-lg align-self-center"},"Apply Package",-1)),l(Ue),U("div",Ie,[l(G,{color:"primary","prepend-icon":"tabler-plus",onClick:e[0]||(e[0]=()=>{p.value=!0})},{default:n(()=>e[10]||(e[10]=[$(" Apply Package ")])),_:1}),l(w,{"is-dialog-visible":u(p),"onUpdate:isDialogVisible":e[1]||(e[1]=c=>b(p)?p.value=c:null),onSubmit:e[2]||(e[2]=c=>a())},null,8,["is-dialog-visible"]),l(w,{"is-dialog-visible":u(h),"onUpdate:isDialogVisible":e[3]||(e[3]=c=>b(h)?h.value=c:null),resource:u(J),onSubmit:e[4]||(e[4]=c=>a())},null,8,["is-dialog-visible","resource"])])]),l(ae),U("div",Me,[l(L,{modelValue:u(P),"onUpdate:modelValue":e[5]||(e[5]=c=>b(P)?P.value=c:null),placeholder:"Search",clearable:""},null,8,["modelValue"])]),l(ae,{class:"mt-4"}),l($e,{"items-per-page":u(i),"onUpdate:itemsPerPage":e[7]||(e[7]=c=>b(i)?i.value=c:null),"model-value":u(C),"onUpdate:modelValue":e[8]||(e[8]=c=>b(C)?C.value=c:null),page:u(s),"onUpdate:page":e[9]||(e[9]=c=>b(s)?s.value=c:null),headers:y,"show-select":"",items:u(o),"items-length":u(A).total,class:"text-no-wrap","onUpdate:options":T},{"item.price":n(({item:c})=>[$(De(ce(c.price)),1)]),"item.status":n(({item:c})=>[l(Ee,Pe(B(c.status??""),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":n(({item:c})=>[l(K,{onClick:H=>de(c)},{default:n(()=>[l(X,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),l(K,null,{default:n(()=>[l(X,{icon:"tabler-dots-vertical"}),l(Te,{activator:"parent"},{default:n(()=>[l(Ne,null,{default:n(()=>[c.status==="active"?(F(),Q(te,{key:0,value:"delete","prepend-icon":"tabler-x",onClick:H=>I(c.id),"base-color":"error"},{default:n(()=>e[12]||(e[12]=[$(" Deactive ")])),_:2},1032,["onClick"])):Z("",!0),c.status==="inactive"?(F(),Q(te,{key:1,value:"reactivate","prepend-icon":"tabler-check",onClick:H=>M(c.id),"base-color":"success"},{default:n(()=>e[13]||(e[13]=[$(" Activate ")])),_:2},1032,["onClick"])):Z("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:n(()=>[l(pe,{page:u(s),"onUpdate:page":e[6]||(e[6]=c=>b(s)?s.value=c:null),"items-per-page":u(A).perPage,"total-items":u(A).total},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}}),Va={__name:"index",setup(q){return(k,d)=>(F(),oe("div",null,[l(he)]))}};export{Va as default};
